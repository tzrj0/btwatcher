# BT Auto - 宝塔面板日志监控系统

一个基于 Electron 的宝塔面板实时日志监控应用，提供网站访问日志的实时监控、分析和管理功能。

## 功能特性

### 核心功能
- **实时日志监控** - 实时获取并显示网站访问日志
- **智能过滤** - 支持按IP、路径、状态码等多维度过滤
- **黑名单管理** - UA黑名单和IP黑名单自动过滤
- **防火墙集成** - 一键添加恶意IP到防火墙规则
- **站点管理** - 多站点切换，301重定向管理
- **文件管理** - 网站文件在线查看和编辑

### 亮点特性
- 🚀 实时监控，自动刷新
- 🔍 强大的搜索和过滤功能
- 🛡️ 集成防火墙管理
- 📊 访问统计分析
- 🎨 现代化UI界面
- 🔐 API密钥加密存储

## 安装和使用

### 环境要求
- Node.js 14.0 或更高版本
- npm 或 yarn
- macOS / Windows / Linux
- 宝塔面板 API 访问权限

### 快速开始

1. 克隆项目
```bash
git clone https://github.com/yourusername/btauto.git
cd btauto
```

2. 安装依赖
```bash
npm install
```

3. 启动应用
```bash
npm start
# 或使用启动脚本
./start.sh
```

### 首次配置

首次启动应用时，会显示初始化界面：

1. 输入宝塔面板的访问地址（如：http://192.168.1.100:8888）
2. 输入API密钥（在宝塔面板-设置-API接口中获取）
3. 点击"保存并连接"

配置信息会加密保存在本地，下次启动自动连接。

### 构建应用

构建 macOS 应用：
```bash
npm run build
# 或
./build-mac.sh
```

构建 Windows 应用：
```bash
npm run build -- --win
```

## 使用说明

### 主界面功能

- **站点选择** - 下拉选择要监控的网站
- **开始/停止监控** - 控制日志监控状态
- **刷新间隔** - 设置自动刷新时间（1-60秒）
- **过滤器** - IP过滤、路径过滤、状态码过滤
- **搜索** - 全文搜索日志内容

### 防火墙管理

1. 点击"防火墙管理"按钮
2. 查看当前防火墙规则列表
3. 添加新规则或删除现有规则
4. 支持批量操作

### 设置选项

- **基础设置** - 刷新间隔、最大显示行数、IP过滤
- **UA黑名单** - 添加需要过滤的User-Agent关键词
- **IP黑名单** - 添加需要过滤的IP地址或IP段
- **API配置管理** - 清空API配置，重新初始化

## 项目结构

```
btauto/
├── main.js           # Electron主进程
├── renderer.js       # 渲染进程主逻辑
├── preload.js        # 预加载脚本
├── index.html        # 主界面
├── init.html         # 初始化界面
├── style.css         # 样式文件
├── lib/
│   └── bt-api.js     # 宝塔API封装
├── build/            # 构建配置
├── dist/             # 构建输出
└── package.json      # 项目配置
```

## API安全

- API密钥使用 AES-256-CBC 加密存储
- 支持API接口IP白名单（建议在宝塔面板中设置）
- 所有API请求使用签名验证

## 注意事项

1. 请确保宝塔面板API接口已开启
2. 建议设置API接口IP白名单
3. 大量日志时可能影响性能，建议合理设置最大显示行数
4. 防火墙规则修改需要谨慎操作

## 开发说明

### 开发环境运行
```bash
npm run dev
```

### 代码规范
- 使用 ESLint 进行代码检查
- 遵循 JavaScript Standard Style

### 调试
在 main.js 中取消注释以下代码开启开发者工具：
```javascript
// mainWindow.webContents.openDevTools();
```

## 许可证

MIT License

## 贡献

欢迎提交 Issue 和 Pull Request！

## 更新日志

### v1.0.0 (2024-01-24)
- 初始版本发布
- 实现基础日志监控功能
- 添加防火墙管理
- 支持多站点切换
- API配置加密存储